<!DOCTYPE html>
<html lang="en">
<head>
  <title>BBM OPERASIONAL</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  <link rel="stylesheet" href="bootstrap.min.css">
  <script src="jquery.slim.min.js"></script>
  <script src="popper.min.js"></script>
  <script src="bootstrap.bundle.min.js"></script>
</head>

<style>


.processing {
    background-color: transparent;
    height: 5%;
    width: 100%;
    border-radius: 1px;
}

.processing-bar {
    background: linear-gradient(to left, #ac0151, #f88080);
    height: 100%;
    width: 0;
    opacity: 0;
    color: #fff;
    border-radius: 11px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 3px 3px -5px #70f2e7, 0 2px 5px #7088f2;
    transition: 7s ease;
}
</style>

<style>
	
#showData {
  font-family: Arial, Helvetica, sans-serif;
  border-collapse: collapse;
  width: 100%;
  text-align: center;
  font-size: 16px;
 
}


td:nth-child(7){display:none;// It will hide the first column of the table}
td:nth-child(8){display:none;// It will hide the first column of the table}
td:nth-child(9){display:none;// It will hide the first column of the table}
td:nth-child(10){display:none;// It will hide the first column of the table}
td:nth-child(12){display:none;// It will hide the first column of the table}
td:nth-child(12){display:none;// It will hide the first column of the table}
td:nth-child(13){display:none;// It will hide the first column of the table}
td:nth-child(14){display:none;// It will hide the first column of the table}
td:nth-child(15){display:none;// It will hide the first column of the table}

#showData tr:nth-child(even){background-color: #f2f2f2;}

#showData tr:hover {background-color: #80FF00;}


   tr:first-child{
  border: 1px solid #000;
  padding-top: 4px;   
  padding-bottom: 4px;
  text-align: center;  
  color: white;
  background: #146775;
  font-size: 16px;
  font-weight: bold;
  
  
  }
  
  #showData tr:nth-child(20) {   /* kosong */
  padding-top: 4px;   
  padding-bottom: 4px;
  text-align: center;  
  background: #FFFFFF;
  font-size: 16px;
  font-weight: bold;  
  height: 20px;
 }

  
  
   #showData tr:nth-child(21) {   /* 3rd row */
  padding-top: 4px;   
  padding-bottom: 4px;
  color: white;
  background: #146775;
  text-align: center;
  font-size: 16px;
  font-weight: bold;
  border: 1px solid #000;
 }


    
	
 </style>
 
 <style>
   #showData tr:not(selector){
  padding-top: 2px;
  padding-bottom: 2px;
  text-align: center;
  font-size: 16px;
  border: 1px solid #ddd;
   }
 </style>
 
 
<style>
	input[type=checkbox]
{
  /* Double-sized Checkboxes */
  -ms-transform: scale(2); /* IE */
  -moz-transform: scale(2); /* FF */
  -webkit-transform: scale(2); /* Safari and Chrome */
  -o-transform: scale(2); /* Opera */
  padding: 10px;
}

label {
    font-size: 12px;
    width: 100%;
    
}

#loader {
  border: 3px solid #f3f3f3;
  border-radius: 50%;
  border-radius: 50%;
  border-top: 3px solid blue;
  border-right: 3px solid green;
  border-bottom: 3px solid red;
  width: 30px;
  height: 30px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
  visibility:hidden;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
  
<body onload="read_value();processing();">
      <br> 
   
  
<div class="container">
	
	
  
  <code id="re" ></code> 
  
  <div class="processing">
        <div class="processing-bar" data-bar="100">
            BBM Operasional 2023
        </div>
    </div>
  
  <hr width="100%" color="green"> 
  <code hidden >2023</code> 
  
  
</div>
  
  
  </form>
  
  <form role="form" id="excel" name="excel" class="was-validated">
    
  </form>
  
</div>


<table align="center" cellspacing="50" class="sticky-column"  id="showData"></table>
<div class="d-flex justify-content-center">
  <div id="loader"></div>
</div>


</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>
  
  var script_url = "https://script.google.com/macros/s/AKfycbzhCTHB_-lWqk3-ENV_ySgv2nwrvQF7qvUfNP-F-wPozmWylKEj/exec";
  
  
  
  function read_value() {
  
  var x = document.getElementById("excel");
  if (x.style.display === "none") {
    x.style.display = "none";
  } else {
    x.style.display = "none";
  }

$("#re").css("visibility","hidden");
   
   document.getElementById("loader").style.visibility = "visible";
 var url = script_url+"?action=read";

$.getJSON(url, function (json) {

    // Set the variables from the results array
   
   
  

        // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");

  

        var header = table.createTHead();
  var row = header.insertRow(0);     
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);
  var cell5 = row.insertCell(4);
  var cell6 = row.insertCell(5);
  var cell7 = row.insertCell(6);
  var cell8 = row.insertCell(7);
  var cell9 = row.insertCell(8);
  var cell10 = row.insertCell(9);
  var cell11 = row.insertCell(10);
  var cell12 = row.insertCell(11);
  var cell13 = row.insertCell(12);
  var cell14 = row.insertCell(13);
  var cell15 = row.insertCell(14);
  var cell16 = row.insertCell(15);
  
  
   
  cell1.innerHTML = "<b>&nbsp;&nbsp;&nbsp;&nbsp;UNIT&nbsp;&nbsp;&nbsp;&nbsp;</b>";
  cell2.innerHTML = "<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tanggal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>";
  cell3.innerHTML = "<b>&nbsp;&nbsp;&nbsp;Km/Hm&nbsp;&nbsp;&nbsp;</b>";
  cell4.innerHTML = "<b>&nbsp;&nbsp;&nbsp;Norma&nbsp;&nbsp;&nbsp;</b>";
  cell5.innerHTML = "<b>&nbsp;&nbsp;&nbsp;Qty&nbsp;&nbsp;&nbsp;</b>";
  cell6.innerHTML = "<b>&nbsp;&nbsp;&nbsp;CostCenter&nbsp;&nbsp;&nbsp;</b>";
  

  
  
        
        // ADD JSON DATA TO THE TABLE AS ROWS  (Sama dengan Excel).
        for (var i = 0; i < json.records.length; i++) {
  
            tr = table.insertRow(-1);
    var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = json.records[i].ID;
    tabCell = tr.insertCell(-1);
    tabCell.innerHTML = json.records[i].Tanggal;   
    tabCell = tr.insertCell(-1);
    tabCell.innerHTML = json.records[i].Total;
    tabCell = tr.insertCell(-1);
    tabCell.innerHTML = json.records[i].Norma;
    tabCell = tr.insertCell(-1);
    tabCell.innerHTML = json.records[i].Qty;     
    tabCell = tr.insertCell(-1);
    tabCell.innerHTML = json.records[i].CostCenter;     
    
            }
      

        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
  document.getElementById("loader").style.visibility = "hidden";
  $("#re").css("visibility","visible");
    });
 }
  
 
  </script>

 
<script>
        const processing = document.querySelector('.processing-bar');

        setTimeout(() => {
            processing.style.opacity = 1;
            processing.style.width = processing.getAttribute('data-bar') + '%';
        }, 500)
    </script>
</html>